# 使い方 (How to Use)

このチャットアプリケーションは、Go言語で作成されたコマンドラインツールです。
ホストPC上でサーバーを起動し、クライアントから接続してチャットを行います。

## 前提条件

* Go言語 (バージョン 1.20以上推奨) がインストールされていること。

## ビルド方法

ターミナルを開き、プロジェクトのルートディレクトリで以下のコマンドを実行して、サーバーとクライアントをビルドします。

```bash
# サーバーのビルド
go build -o server_bin ./server

# クライアントのビルド
go build -o client_bin ./client

go build -o ./test/server ./server && go build -o ./test/client ./client
```

Windowsの場合は `.exe` が付く場合があります（例: `server_bin.exe`）。

## 実行方法

### 1. サーバーの起動

まず、サーバーを起動します。

```bash
./server_bin
```

* サーバーはデフォルトでポート `8080` で待機します。
* 初回起動時に `users.json` と `messages.json` が同じディレクトリに作成されます。これらにデータが保存されます。

### 2. クライアントの起動

別のターミナルウィンドウを開き、クライアントを起動します。

```bash
./client_bin
```

* デフォルトで `localhost:8080` に接続します。
* 別のPCのサーバーに接続する場合は、`-host` オプションを使用します。
  ```bash
  ./client_bin -host 192.168.1.10:8080
  ```

## チャットの使い方

### ユーザー登録 (初回のみ)

チャットに参加するには、まずユーザー登録が必要です。
メッセージ入力欄に以下のコマンドを入力して Enter を押してください。

```
/register <ユーザー名> <パスワード>
```

例:
```
/register satoshi mypassword123
```
成功すると、自動的にログインされます。

### ログイン

2回目以降の起動時は、以下のコマンドでログインしてください。

```
/login <ユーザー名> <パスワード>
```

例:## クライアントの実行

```bash
./test/client
```

クライアント起動時はサーバーに接続されていません。以下のコマンドで接続してください。

```text
/connect localhost:8999
```

（サーバーのIPとポートを指定してください。ポート未指定の場合は `:8999` が使用されます）

切断するには：

```text
/unconnect
```

## チャットコマンド

- `/register <username> <password>`: ユーザー登録
- `/login <username> <password>`: ログイン
- `/logout`: ログアウト
- `/name <new_name>`: 表示名の変更
- `/help`: ヘルプ表示

### 管理者コマンド

- `/admin <password>`: 管理者権限の取得
- `/ban <ip_id>`: ユーザーのBan（IP ID指定）
- `/kick <ip_id>`: ユーザーのKick（IP ID指定）

* パスワードはハッシュ化されて保存されますが、通信は（TLS設定をしない限り）平文のWebSocketで行われるため、公共のネットワークでの利用には注意してください。
* サーバーを停止するには、サーバーを実行しているターミナルで `Ctrl+C` を押してください。
